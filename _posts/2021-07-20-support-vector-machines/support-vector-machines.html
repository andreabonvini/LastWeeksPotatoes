<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Support Vector Machines</title>

  <meta property="description" itemprop="description" content="The math behind the Support Vector Machines algorithm."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-20"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-20"/>
  <meta name="article:author" content="Andrea Bonvini"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Support Vector Machines"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="The math behind the Support Vector Machines algorithm."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Support Vector Machines"/>
  <meta property="twitter:description" content="The math behind the Support Vector Machines algorithm."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","preview"]}},"value":[{"type":"character","attributes":{},"value":["Support Vector Machines"]},{"type":"character","attributes":{},"value":["The math behind the Support Vector Machines algorithm.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Andrea Bonvini"]},{"type":"character","attributes":{},"value":["https://github.com/andreabonvini"]}]}]},{"type":"character","attributes":{},"value":["07-20-2021"]},{"type":"character","attributes":{},"value":["Machine Learning","Classification"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["media/outer_points2D-white.png"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["media/00_points1-white.png","media/01_points2-white.png","media/02_classification_line-white.png","media/03_who_are_the_support_vectors-white.png","media/04_margins-white.png","media/05_distances-white.png","media/im1.png","media/im2.png","media/inner_points2D-white.png","media/outer_points2D-white.png","media/rotate-white.mov","media/rotate-white.mp4","media/svm-white.mov","media/svm-white.mp4","support-vector-machines_files/anchor-4.2.2/anchor.min.js","support-vector-machines_files/bowser-1.9.3/bowser.min.js","support-vector-machines_files/distill-2.2.21/template.v2.js","support-vector-machines_files/header-attrs-2.9/header-attrs.js","support-vector-machines_files/jquery-1.11.3/jquery.min.js","support-vector-machines_files/popper-2.6.0/popper.min.js","support-vector-machines_files/tippy-6.2.7/tippy-bundle.umd.min.js","support-vector-machines_files/tippy-6.2.7/tippy-light-border.css","support-vector-machines_files/tippy-6.2.7/tippy.css","support-vector-machines_files/tippy-6.2.7/tippy.umd.min.js","support-vector-machines_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="support-vector-machines_files/header-attrs-2.9/header-attrs.js"></script>
  <script src="support-vector-machines_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="support-vector-machines_files/popper-2.6.0/popper.min.js"></script>
  <link href="support-vector-machines_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="support-vector-machines_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="support-vector-machines_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="support-vector-machines_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="support-vector-machines_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="support-vector-machines_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="support-vector-machines_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Support Vector Machines","description":"The math behind the Support Vector Machines algorithm.","authors":[{"author":"Andrea Bonvini","authorURL":"https://github.com/andreabonvini","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-20T00:00:00.000+00:00","citationText":"Bonvini, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Support Vector Machines</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Machine Learning</div>
<div class="dt=tag">Classification</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>The math behind the Support Vector Machines algorithm.</p></p>
</div>

<div class="d-byline">
  Andrea Bonvini <a href="https://github.com/andreabonvini" class="uri">https://github.com/andreabonvini</a> 
  
<br/>07-20-2021
</div>

<div class="d-article">
<h3 id="introduction-brief-history">Introduction &amp; Brief History</h3>
<p>In this blog-post we are gonna talk about one of the most powerful and fascinating techniques in Machine Learning: Support Vector Machines.</p>
<p>In the field of Statistical Learning the <em>Support Vector Machine</em> technique is a <em>binary classification</em> algorithm which aims to find the hyperplane which is able to separate the data with the largest <em>margin</em> possible. The concept of margin is illustrated in the following images.</p>
<p>Suppose we have a set of points in <span class="math inline">\(\mathbb{R}^2\)</span>, each point belongs to a class <span class="math inline">\(\in\{-1,+1\}\)</span></p>
<center>
<img src="media/01_points2-white.png" style="width:60.0%" />
</center>
<p>We want to find the best hyperplane (in this case a <em>line</em>) which is able to correctly separate the data.</p>
<center>
<img src="media/02_classification_line-white.png" style="width:60.0%" />
</center>
<p>We identify this hyperplane by maximizing the <em>margin</em>, i.e. the distance from the <em>hyperplane</em> to the closest points of both classes, we call this points <em>support vectors</em>.</p>
<center>
<img src="media/03_who_are_the_support_vectors-white.png" style="width:60.0%" />
</center>
<p>In this case we identified two <em>support vectors</em>, they are called like that because they support the dashed lines, which represent the set of points equidistant from the separating hyperplane.</p>
<center>
<img src="media/04_margins-white.png" style="width:60.0%" />
</center>
<p>The <em>margins</em> from the support vectors to the hyperplane are drawed in red</p>
<center>
<img src="media/05_distances-white.png" style="width:60.0%" />
</center>
<p>Before diving into the theory of the algorithm let’s have a look at the history behind it.</p>
<p>The birth of SVMs dates back to <span class="math inline">\(1963\)</span> in Russia, when <em>Vladimir Vapnik</em> and <em>Aleksondr Lerner</em> introduced the Generalized Portrait algorithm.</p>
<p>After almost <span class="math inline">\(30\)</span> years, at the end of <span class="math inline">\(1990\)</span>, <em>Vapnik</em> moved to the USA and joined <em>Bernhard Boser</em> and <em>Isabelle Guyen</em> at the Adaptive Systems Research Department at AT&amp;T Bell Labs in New Jersey, where the algorithm was refined.</p>
<blockquote>
<p><em>“The invention of SVMs happened when Bernhard decided to implement Vladimir’s algorithm in the three months we had left before we moved to Berkeley. After some initial success of the linear algorithm, Vladimir suggested introducing products of features. I proposed to rather use the kernel trick of the ‘potential function’ algorithm. Vladimir initially resisted the idea because the inventors of the ‘potential functions’ algorithm (Aizerman, Braverman, and Rozonoer) were from a competing team of his institute back in the 1960’s in Russia! But Bernhard tried it anyways, and the SVMs were born!”</em></p>
</blockquote>
<p><em>Isabelle Guyen</em></p>
<h3 id="premise-on-linear-classifiers">Premise on <em>linear</em> classifiers</h3>
<p>For a <em>binary</em> classification problem, one can visualize the operation of a linear classifier as splitting a high-dimensional input space of dimension <span class="math inline">\(d\)</span> with an <em>hyperplane</em> of dimension <span class="math inline">\(d\)</span> (which, as you’ll see in a minute, corresponds to a <span class="math inline">\(d-1\)</span> dimensional space): all points on one side of the hyperplane are classified as <span class="math inline">\(+1\)</span> (or <span class="math inline">\(-1\)</span>), while the others are classified as <span class="math inline">\(-1\)</span> (or <span class="math inline">\(+1\)</span>). In case you doubt the power of linear classifiers just observe that we’re always able to transform (or enrich) our input space by means of some <em>basis functions</em>, if we “guess” the right transformation maybe we are able to correctly classify our samples with a <em>linear</em> classifier.</p>
<p>If, for instance, we have the following unseparable data in the 2D space</p>
<center>
<img src="media/outer_points2D-white.png" style="width:60.0%" />
</center>
<p>there’s nothing stopping us from enriching the input space with some new coordinates which depend on the old features, e.g. by adding a ne w dimension <span class="math inline">\(x_3 = \sqrt{x_1^2+x_2^2}\)</span>.</p>
<video width="720" height="540" controls>
<source src="media/svm-white.mp4" type="video/mp4">
</video>
<p>This way, in the new 3D input space, we are able to correctly classify the data by means of a 2D <em>plane</em>.</p>
<video width="720" height="540" controls>
<source src="media/rotate-white.mp4" type="video/mp4">
</video>
<h3 id="derivation">Derivation</h3>
<p>First of all, we should be familiar with the equation of a generic <span class="math inline">\(D\)</span>-dimensional hyperplane:</p>
<p><span class="math display">\[
\text{hyperplane: }\\
\mathbf{w}^T\mathbf{x}=0\\
\mathbf{w} = [w_0,w_1,\dots,w_D]^T\\
\mathbf{x} = [1,x_1,\dots,x_D]^T
\]</span></p>
<p>If <span class="math inline">\(D=2\)</span> we have that</p>
<p><span class="math display">\[
\text{hyperplane: }\\
w_0+w_1x_1+w_2x_2=0\\
\mathbf{w} = [w_0,w_1,w_2]^T\\
\mathbf{x} = [1,x_1,x_2]^T
\]</span></p>
<p>Let <span class="math inline">\(\mathbf{x}_N\)</span> be the nearest data point to the <em>hyperplane</em> <span class="math inline">\(\mathbf{w}^T\mathbf{x} = 0\)</span> , before finding the distance we just have to state two observations:</p>
<ul>
<li><p>Let’s say I multiply the vector <span class="math inline">\(\mathbf{w}\)</span> by <span class="math inline">\(1000000\)</span> , I get the <em>same</em> hyperplane! So any formula that takes <span class="math inline">\(\mathbf{w}\)</span> and produces the margin will have to have built-in <em>scale-invariance</em>, we do that by normalizing <span class="math inline">\(\mathbf{w}\)</span> , requiring that for the nearest data point <span class="math inline">\(\mathbf{x}_N\)</span>: <span class="math display">\[
  |\mathbf{w}^T\mathbf{x}_N|=1
  \]</span> ( So I just scale <span class="math inline">\(\mathbf{w}\)</span> up and down in order to fulfill the condition stated above, we just do it because it’s <em>mathematically convenient</em>! By the way remember that <span class="math inline">\(1\)</span> does <em>not</em> represent the Euclidean distance)</p></li>
<li><p>When you solve for the margin, the <span class="math inline">\(w_1\)</span> to <span class="math inline">\(w_d\)</span> will play a completely different role from the role of <span class="math inline">\(w_0\)</span> , so it is no longer convenient to have them on the same vector. We pull out <span class="math inline">\(w_0\)</span> from <span class="math inline">\(\mathbf{w}\)</span> and rename <span class="math inline">\(w_0\)</span> with <span class="math inline">\(b\)</span> (for <em>bias</em>).</p></li>
</ul>
<p><span class="math display">\[
\mathbf{w} = (w_1,\dots,w_d)\\w_0=b
\]</span></p>
<p>So now our notation is changed:</p>
<p>The <em>hyperplane</em> is represented by</p>
<p><span class="math display">\[
\mathbf{w}^T\mathbf{x} +b= 0
\]</span></p>
<p>and our constraint becomes</p>
<p><span class="math display">\[
|\mathbf{w}^T\mathbf{x}_N+b|=1
\]</span></p>
<p>It’s trivial to demonstrate that the vector <span class="math inline">\(\mathbf{w}\)</span> is orthogonal to the <em>hyperplane</em>, just suppose to have two point <span class="math inline">\(\mathbf{x}&#39;\)</span> and <span class="math inline">\(\mathbf{x&#39;&#39;}\)</span> belonging to the <em>hyperplane</em> , then <span class="math inline">\(\mathbf{w}^T\mathbf{x}&#39; +b= 0\)</span> and <span class="math inline">\(\mathbf{w}^T\mathbf{x}&#39;&#39; +b= 0\)</span>.</p>
<p>And of course <span class="math inline">\(\mathbf{w}^T\mathbf{x}&#39;&#39; +b - (\mathbf{w}^T\mathbf{x}&#39; +b)=\mathbf{w}^T(\mathbf{x}&#39;&#39;-\mathbf{x}&#39;) = 0\)</span></p>
<p>Since <span class="math inline">\(\mathbf{x}&#39;&#39;-\mathbf{x}&#39;\)</span> is a vector which lays on the <em>hyperplane</em> , we deduce that <span class="math inline">\(\mathbf{w}\)</span> is orthogonal to the <em>hyperplane</em>.</p>
<center>
<img src="media/im1.png" style="width:60.0%" />
</center>
<p>Then the distance from <span class="math inline">\(\mathbf{x}_N\)</span> to the <em>hyperplane</em> can be expressed as a dot product between <span class="math inline">\(\mathbf{x}_N-\mathbf{x}\)</span> (where <span class="math inline">\(\mathbf{x}\)</span> is any point belonging to the plane) and the unit vector <span class="math inline">\(\hat{\mathbf{w}}\)</span> where <span class="math inline">\(\hat{\mathbf{w}} = \frac{\mathbf{w}}{\vert\vert\mathbf{w}\vert\vert}\)</span></p>
<p>(the distance is just the projection of <span class="math inline">\(\mathbf{x}_N-\mathbf{x}\)</span> in the direction of <span class="math inline">\(\hat{\mathbf{w}}\)</span>!)</p>
<p><span class="math display">\[
distance = |\hat{\mathbf{w}}^T(\mathbf{x}_N-\mathbf{x})|
\]</span></p>
<p>We take the absolute value since we don’t know if <span class="math inline">\(\mathbf{w}\)</span> is facing <span class="math inline">\(\mathbf{x}_N\)</span> or is facing the other direction</p>
<center>
<img src="media/im2.png" style="width:60.0%" />
</center>
<p>We’ll now try to simplify our notion of <em>distance</em>.</p>
<p><span class="math display">\[
\text{distance} = |\hat{\mathbf{w}}^T(\mathbf{x}_N-\mathbf{x})\;| = \frac{1}{||\mathbf{w}||}|\;\mathbf{w}^T\mathbf{x}_N-\mathbf{w}^T\mathbf{x}|
\]</span></p>
<p>This can be simplified if we add and subtract the missing term <span class="math inline">\(b\)</span>.</p>
<p><span class="math display">\[
distance = \frac{1}{||\mathbf{w}||}|\;\mathbf{w}^T\mathbf{x}_N+b-\mathbf{w}^T\mathbf{x}-b\;| = \frac{1}{||\mathbf{w}||}|\;\mathbf{w}^T\mathbf{x}_N+b-(\mathbf{w}^T\mathbf{x}+b)\;|
\]</span></p>
<p>Well, <span class="math inline">\(\mathbf{w}^T\mathbf{x}+b\)</span> is just the value of the equation of the plane…for a point <em>on</em> the plane. So without any doubt <span class="math inline">\(\mathbf{w}^T\mathbf{x}+b= 0\)</span> , our notion of <em>distance</em> becomes</p>
<p><span class="math display">\[
distance = \frac{1}{||\mathbf{w}||}|\;\mathbf{w}^T\mathbf{x}_N+b\;|
\]</span></p>
<p>But wait… what is <span class="math inline">\(\vert\mathbf{w}^T\mathbf{x}_N+b\vert\)</span> ? It is the constraint that we defined at the beginning of our derivation!</p>
<p><span class="math display">\[
\vert\mathbf{w}^T\mathbf{x}_N+b\vert=1
\]</span></p>
<p>So we end up with the formula for the distance being just</p>
<p><span class="math display">\[
distance = \frac{1}{\vert\vert\mathbf{w}\vert\vert}
\]</span></p>
<p>Let’s now formulate the optimization problem, we have:</p>
<p><span class="math display">\[
\underset{w}{\operatorname{max}}\frac{1}{||\mathbf{w}||}\\\text{subject to}\;\underset{n=1,2,\dots,N}{\operatorname{min}}|\mathbf{w}^T\mathbf{x}_n+b|=1
\]</span></p>
<p>Since this is not a <em>friendly</em> optimization problem (the constraint is characterized by a minimum and an absolute, which are annoying) we are going to find an equivalent problem which is easier to solve. Our optimization problem can be rewritten as</p>
<p><span class="math display">\[
\underset{w}{\operatorname{min}}\frac{1}{2}\mathbf{w}^T\mathbf{w}
\\
\text{subject to} \ \ \ \  y_n \cdot(\mathbf{w}^T\mathbf{x}_n+b)\ge1 \;\;\;\;\text{for $n = 1,2,\dots,N$}
\]</span></p>
<p>where <span class="math inline">\(y_n\)</span> is a variable that we introduce that will be equal to either <span class="math inline">\(+1\)</span> or <span class="math inline">\(-1\)</span> accordingly to its real target value (remember that this is a <em>supervised learning</em> technique and we know the real target value of each sample). One could argue that the new constraint is actually different from the former one, since maybe the <span class="math inline">\(\mathbf{w}\)</span> that we’ll find will allow the constraint to be <em>strictly</em> greater than <span class="math inline">\(1\)</span> for every possible point in our dataset [ <span class="math inline">\(y_n(\mathbf{w}^T\mathbf{x}_n+b)&gt; 1 \;\;\forall{n}\)</span> ] while we’d like it to be <em>exactly</em> equal to <span class="math inline">\(1\)</span> for <em>at least</em> one value of <span class="math inline">\(n\)</span>. But that’s actually not true! Since we’re trying to minimize <span class="math inline">\(\frac{1}{2}\mathbf{w}^T\mathbf{w}\)</span> our algorithm will try to scale down <span class="math inline">\(\mathbf{w}\)</span> until <span class="math inline">\(\mathbf{w}^T\mathbf{x}_n+b\)</span> will touch <span class="math inline">\(1\)</span> for some specific point <span class="math inline">\(n\)</span> of the dataset.</p>
<p>So how can we solve this? This is a constraint optimization problem with inequality constraints, we have to derive the <em>Lagrangian</em> and apply the <em>KKT</em> (Karush–Kuhn–Tucker) conditions.</p>
<p><em>Objective Function:</em></p>
<p>We have to minimize</p>
<p><span class="math display">\[
\mathcal{L}(\mathbf{w},b,\mathbf{\alpha}) = \frac{1}{2}\mathbf{w}^T\mathbf{w}-\sum_{n=1}^{N}\alpha_n(y_n(\mathbf{w}^T\mathbf{x}_n+b)-1)\\
\]</span></p>
<p><em>w.r.t.</em> to <span class="math inline">\(\mathbf{w}\)</span> and <span class="math inline">\(b\)</span> and maximize it <em>w.r.t.</em> the <em>Lagrange Multipliers</em> <span class="math inline">\(\alpha_n\)</span></p>
<p>We can easily get the two conditions for the unconstrained part:</p>
<p><span class="math display">\[
\nabla_{\mathbf{w}}\mathcal{L}=\mathbf{w}-\sum_{n=1}^{N}\alpha_n y_n\mathbf{x}_n = 0 \;\;\;\;\;\;\;\; \mathbf{w}=\sum_{n=1}^{N}\alpha_n y_n\mathbf{x}_n\\
\frac{\partial\mathcal{L}}{\partial b} = -\sum_{n=1}^{N}\alpha_n y_n = 0\;\;\;\;\;\;\;\;\;\;\;\sum_{n=1}^{N}\alpha_n y_n=0
\]</span></p>
<p>And list the other <em>KKT</em> conditions:</p>
<p><span class="math display">\[
y_n(\mathbf{w}^T\mathbf{x}_n+b)-1\ge0\;\;\;\;\;\;\forall{n}\\
\alpha_n\ge0\;\;\;\;\;\;\;\forall{n}\\
\alpha_n(y_n(\mathbf{w}^T\mathbf{x}_n+b)-1)=0\;\;\;\;\;\;\forall{n}
\]</span></p>
<p><em>Alert</em> : the last condition is called the KKT <em>dual complementary condition</em> and will be key for showing that the SVM has only a small number of “support vectors”, and will also give us our convergence test when we’ll talk about the <em>SMO</em> algorithm.</p>
<p>Now we can reformulate the <em>Lagrangian</em> by applying some substitutions</p>
<p><span class="math display">\[
\mathcal{L}(\mathbf{w},b,\mathbf{\alpha}) = \frac{1}{2}\mathbf{w}^T\mathbf{w}-\sum_{n=1}^{N}\alpha_n(y_n(\mathbf{w}^T\mathbf{x}_n+b)-1)\\
\mathcal{L}(\mathbf{\alpha}) =\sum_{n=1}^{N}\alpha_n-\frac{1}{2}\sum_{n=1}^{N}\sum_{m=1}^{M}y_n y_m\alpha_n\alpha_m\mathbf{x}_n^T\mathbf{x}_m
\]</span></p>
<p>(if you have doubts just go to minute 36.50 of <a href="https://www.youtube.com/watch?v=eHsErlPJWUU">this</a> excellent lecture by professor Yaser Abu-Mostafa at <em>Caltech</em> )</p>
<p>We end up with the <em>dual</em> formulation of the problem</p>
<p><span class="math display">\[
\underset{\alpha}{\operatorname{argmax}}\sum_{n=1}^{N}\alpha_n-\frac{1}{2}\sum_{n=1}^{N}\sum_{m=1}^{M}y_n y_m\alpha_n\alpha_m\mathbf{x}_n^T\mathbf{x}_m\\
\;\\
s.t. \;\;\;\;\;\;\;\;\alpha_n\ge0\;\;\;\forall{n}\\
\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\sum_{n=1}^{N}\alpha_n y_n=0
\]</span></p>
<p>We can notice that the old constraint <span class="math inline">\(\mathbf{w}=\sum_{n=1}^{N}\alpha_n y_n\mathbf{x}_n\)</span> doesn’t appear in the new formulation since it is <em>not</em> a constraint on <span class="math inline">\(\alpha\)</span> , it was a constraint on <span class="math inline">\(\mathbf{w}\)</span> which is not part of our formulation anymore.</p>
<p>How do we find the solution? we throw this objective (which btw happens to be a <em>convex</em> function) to a <em>quadratic programming</em> package.</p>
<p>Once the <em>quadratic programming</em> package gives us back the solution we find out that a whole bunch of <span class="math inline">\(\alpha\)</span> are just <span class="math inline">\(0\)</span> ! All the <span class="math inline">\(\alpha\)</span> which are not <span class="math inline">\(0\)</span> are the ones associated with the so-called <em>support vectors</em> ! ( which are just samples from our dataset )<br />
They are called <em>support</em> vectors because they are the vectors that determine the width of the <em>margin</em> , this can be noted by observing the last <em>KKT</em> condition</p>
<p><span class="math display">\[
\big\{\alpha_n(y_n(\mathbf{w}^T\mathbf{x}_n+b)-1)=0\;\;\;\forall{n}\big\}
\]</span></p>
<p>in fact either a constraint is active, and hence the point is a support vector, or its multiplier is zero.</p>
<p>Now that we solved the problem we can get both <span class="math inline">\(\mathbf{w}\)</span> and <span class="math inline">\(b\)</span>.</p>
<p><span class="math display">\[
\mathbf{w} = \sum_{\mathbf{x}_n \in \text{ SV}}\alpha_ny_n\mathbf{x}_n\\
y_n(\mathbf{w}^T\mathbf{x}_{n\in\text{SV}}+b)=1
\]</span></p>
<p>where <span class="math inline">\(\mathbf{x}_{n\in\text{SV}}\)</span> is any <em>support vector</em>. (you’d find the <em>same</em> <span class="math inline">\(b\)</span> for every support vector)</p>
<p>But the coolest thing about <em>SVMs</em> is that we can rewrite our <em>objective functions</em> from</p>
<p><span class="math display">\[
\mathcal{L}(\mathbf{\alpha}) =\sum_{n=1}^{N}\alpha_n-\frac{1}{2}\sum_{n=1}^{N}\sum_{m=1}^{M}y_n y_m\alpha_n\alpha_m\mathbf{x}_n^T\mathbf{x}_m
\]</span></p>
<p>to</p>
<p><span class="math display">\[
\mathcal{L}(\mathbf{\alpha}) =\sum_{n=1}^{N}\alpha_n-\frac{1}{2}\sum_{n=1}^{N}\sum_{m=1}^{M}y_n y_m\alpha_n\alpha_mk(\mathbf{x}_n,\mathbf{x}_m)
\]</span></p>
<p>We can use <em>kernels</em> ! (if you don’t know what I’m talking about just check <a href="https://theoptimalpolicy.github.io/2020/12/04/kernels/">this</a> one)</p>
<p>Finally we end up with the following equation for classifying <em>new points</em>:</p>
<p><span class="math display">\[
\hat{y}(\mathbf{x}) = sign\left(\sum_{n=1}^{N}\alpha_n y_n k(\mathbf{x},\mathbf{x}_n)+b\right)
\]</span></p>
<h3 id="soft-margin-formulation">Soft-margin Formulation</h3>
<p>The method described so far is called <em>hard-margin SVM</em> since the margin has to be satisfied strictly, it can happen that the points are not <em>linearly separable</em> in <em>any</em> way, or we just want to handle <em>noisy data</em> to avoid overfitting, so now we’re going to briefly define another version of it, which is called <em>soft-margin SVM</em> that allows for few errors and penalizes for them.</p>
<p>We introduce <em>slack variables</em> <span class="math inline">\(\xi_n\)</span> , this way we allow to <em>violate</em> the margin constraint but we add a <em>penalty</em> expressed by the distance of the misclassified samples from the hyperplane ( samples correctly classified have <span class="math inline">\(\xi_n=0\)</span>).</p>
<p>We now have to</p>
<p><span class="math display">\[
\text{Minimize}\ \ ||\mathbf{w}||_2^2+C\sum_n \xi_n \\
\text{s.t.}\\ 
\ y_n(\mathbf{w}^Tx_n+b)\ge1-\xi_n\ ,\ \ \ \forall{n}\\
\xi_n\ge0\ ,\ \ \ \forall{n}
\]</span></p>
<p><span class="math inline">\(C\)</span> is a coefficient that allows to trade-off bias-variance and is chosen by <em>cross-validation</em>.</p>
<p>And obtain the <em>Dual Representation</em></p>
<p><span class="math display">\[
\text{Maximize}\ \ \ \mathcal{L}(\mathbf{\alpha}) =\sum_{n=1}^{N}\alpha_n-\frac{1}{2}\sum_{n=1}^{N}\sum_{m=1}^{M}y_n y_m\alpha_n\alpha_mk(\mathbf{x}_n\mathbf{x}_m)\\
  \text{s.t.}\\
  0\le\alpha_n\le C\ \ \ \ \ \forall{n}\\
  \sum_{n=1}^N\alpha_n y_n = 0
\]</span></p>
<p>if <span class="math inline">\(\alpha_n\le0\)</span> the point <span class="math inline">\(x_n\)</span> is just correctly classified.</p>
<p>if <span class="math inline">\(0&lt;\alpha_n&lt;C\)</span> the points lies <em>on the margin</em>. They are indeed Support Vectors.</p>
<p>if <span class="math inline">\(\alpha_n = C\)</span> the point lies <em>inside the margin</em>, and it can be either <em>correctly classified</em> (<span class="math inline">\(\xi_n \le 1\)</span>) or <em>misclassified</em> (<span class="math inline">\(\xi_n&gt;1\)</span>)</p>
<p>Fun fact: When <span class="math inline">\(C\)</span> is large, larger slacks penalize the objective function of SVM’s more than when <span class="math inline">\(C\)</span> is small. As <span class="math inline">\(C\)</span> approaches infinity, this means that having any slack variable set to non-zero would have infinite penalty. Consequently, as <span class="math inline">\(C\)</span> approaches infinity, all slack variables are set to <span class="math inline">\(0\)</span> and we end up with a hard-margin SVM classifier.</p>
<h3 id="error-bounds">Error bounds</h3>
<p>And what about generalization? Can we compute an <em>Error</em> bound in order to see if our model is overfitting?</p>
<p>As <em>Vapnik</em> said :</p>
<blockquote>
<p>“In the support-vectors learning algorithm the complexity of the construction does not depend on the dimensionality of the feature space, but on the number of support vectors.”</p>
</blockquote>
<p>It’s reasonable to define an upper bound of the error as:</p>
<p><span class="math display">\[
L_h\le\frac{\mathbb{E}[\text{number of support vectors}]}{N}
\]</span></p>
<p>Where <span class="math inline">\(N\)</span> is the total number of samples in the dataset. The good thing is that this bound can be easily computed and we don’t need to run SVM multiple times.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
